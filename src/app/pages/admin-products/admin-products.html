<div class="container p-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Mis Productos</h2>
        <a routerLink="/admin/product/new" class="btn btn-success">
        + Agregar Producto</a>
    </div>

    @if (isloading) {
        <p>Cargando...</p>
    } @else { 
        <div class="list-group">
            @for (item of myProduct; track item.id) {
                <div class="list-group-item p-3 shadow-sm mb-3 border rounded">
                    <div class="d-flex justify-content-between flex-wrap-sm">
                        <h4 class="mb-1">{{ item.name }}</h4>
                        
                        <div class="d-flex flex-column align-items-end">
                            @if ((item.discount || 0) > 0) {
                                <span class="text-decoration-line-through text-muted small">${{ item.price }}</span>
                                <span class="badge bg-success fs-6">
                                     ${{ item.price * (1 - item.discount / 100) | number:'1.2-2' }} <!-- solo agrega dos decimales despues la coma--> 
                                </span> <!-- el dueÃ±o ve inmediatamente cuanto va a pagar el cliente-->
                            } @else {
                                <span class="badge bg-primary fs-6">${{ item.price }}</span>
                            }
                        </div>
                    </div>

                    <p class="text-muted mb-2">{{ item.description }}</p>

                    <div class="d-flex flex-wrap gap-3 flex-column-sm">
                        <button
                            class="btn btn-sm"
                            [class.btn-warning]="item.isHappyHour"
                            [class.btn-outline-secondary]="!item.isHappyHour"
                            (click)="cambiarHappyHour(item)">
                            Happy Hour: {{ item.isHappyHour ? 'En Happy Hour' : 'Fuera de Happy Hour' }}
                        </button>

                        <div class="input-group input-group-sm w-100 w-md-auto" style="width: 180px;">
                            <span class="input-group-text">Descuento %</span>
                            <input type="number" class="form-control" [value]="item.discount" #discountInput>
                            <button class="btn btn-outline-primary" (click)="cambiarDescuento(item.id, discountInput.value)">
                                OK
                            </button>
                        </div>

                        <div class="ms-auto d-flex gap-2 w-100 w-md-auto">
                            <a [routerLink]="['/admin/product/edit', item.id]" class="btn btn-sm btn-info text-white w-50">
                                Editar Producto
                            </a>
                            <button class="btn btn-sm btn-danger w-50" (click)="borrarProducto(item.id)">
                                Eliminar Producto
                            </button>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>